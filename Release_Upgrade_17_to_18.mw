{{Header}}
{{title|title=
Release Upgrade {{project_name_long}} 17 to {{project_name_long}} 18
}}
{{#seo:
|description=How to Release Upgrade from {{project_name_short}} 17 to {{project_name_short}} 18
|image=Upgrade.jpg
}}
[[File:Upgrade.jpg|thumb]]
{{intro|
How to Release Upgrade from {{project_name_short}} 17 to {{project_name_short}} 18
}}
= Notices =
{{testers-only}}

{| class="wikitable"
|+ ''Release Upgrade {{project_name_short}} Notices''

|-
! '''Notice'''
! '''Description'''
|-

! Difficulty
|
* Downloading a new {{project_name_gateway_long}} / {{project_name_workstation_long}} ([[Factory Reset]]) is easier than applying the [[Release Upgrade|Release Upgrade]] instructions on this page.
* Debian release notes:
** [https://www.debian.org/releases/stable/release-notes/upgrading.html Chapter 4. Upgrades from Debian 12 (trixie)]
** [https://www.debian.org/releases/stable/release-notes/issues.en.html Chapter 5. Issues to be aware of for trixie]
|-

! Release Upgrade vs Re-Installation
|
To use [[About|{{project_name_short}}]] 18, users can either:

* '''A)''' Release upgrade existing {{project_name_short}} 17 images using the instructions on this page; <u>OR</u>
* '''B)''' Factory Reset using the {{project_name_short}} re-install method by downloading the new release, which is much simpler than upgrading:
** [[{{non_q_project_name_short}}|{{non_q_project_name_short}}]] 18: [[Download|download the new release]].
** [[{{q_project_name_short}}|{{q_project_name_long}}]] 18: [[Qubes/Install|download the new release]].
|-

! Standard Updates
|
* For standard ("everyday") update instructions see [[Operating System Software and Updates]]. <br />
* The instructions on this page describe how to perform a [[Release Upgrade]] from {{project_name_short}} 17 to {{project_name_short}} 18.
|-

! Automated Release Upgrade vs Manual Release Upgrade
|
* [[#Release Upgrade|Automated Release Upgrade]] is the newer method that has been implemented. It does not ask for user input and is therefore easier to use.
* The former Manual Release Upgrade effectively did the same, but it offered more control over system customization. It is now [[Deprecated#Manual Release Upgrade|deprecated]]. <ref>
This method is still possible. All the automated {{Github_link|repo=legacy-dist|path=/blob/master/usr/sbin/release-upgrade|text=<code>release-upgrade</code>}} script does is perform actions which the user could perform manually. If a manual release upgrade is desired, emulate what the <code>release-upgrade</code> script is doing. The manual release upgrading procedure is [[Unsupported|undocumented]] due to the size of the instructions and duplication involved.
</ref>
|-

! Configuration Files Resets
| Since this is an automated release upgrade, user modified configuration files (if any) in folder <code>/etc</code> will be reset, overwritten with the Debian or {{project_name_short}} package version. The user is free to restore the configuration after the release upgrade.
|-

|}

= High Level Overview =

# Backup all data - ideally have a copy of the VM(s) so it is possible to try again (if necessary).
# Perform the usual [[Operating_System_Software_and_Updates#Standard_Upgrade_Steps|standard ("everyday") update instructions]].
# Platform specific notice. Qubes users only: Release Upgrade Qubes from version R4.2 to R4.3.
# Release Upgrade {{project_name_workstation_short}} from version 17 to 18.
# Update derivative APT repository configuration.
# Power off {{project_name_workstation_short}}
# Release Upgrade {{project_name_gateway_short}}
# Restart {{project_name_gateway_short}}

= Platform Specific Notices =
* [[{{project_name_short}}|{{project_name_short}}]]: No special notice.
* [[{{q_project_name_short}}|{{q_project_name_short}}]]:
** Qubes R4.2: Unavailable, [[unsupported]] for Qubes R4.2. <ref>
* [https://github.com/QubesOS/qubes-issues/issues/10219 decide availability of Kicksecure, and Whonix 18 (Debian trixie based) on Qubes R4.2 versus R4.3]
* {{project_name_short}} 18 issue in Qubes R4.2 sdwdate-gui:
[https://forum.qubes-os.org/t/whonix-18-denied-sdwdate-connectcheck/36098 qrexec <code>sdwdate.ConnectCheck</code> denied messages] (despite the name, sdwdate-gui issue, not sdwdate issue)
</ref>
** Qubes R4.3: Available for Qubes R4.3 and above only.

== Qubes Specific ==
<u>Notes:</u>

* <u>Qubes applicability:</u> Only applicable if using Qubes. Non-Qubes users should ignore this wiki chapter.
* <u>Required host version:</u> Host operating system must be Qubes R4.3. See Qubes documentation: [https://doc.qubes-os.org/en/latest/user/downloading-installing-upgrading/upgrade/4_3.html How to upgrade to Qubes 4.3]
* <u>Template upgrade note:</u> When Qubes R4.3 is in dom0 with an old Qubes R4.2 Template, that Template must be upgraded to Qubes R4.3 first. The following quotes from the Qubes documentation explain how to upgrade all Templates from R4.2 to R4.3.

{{quotation
|quote=
Install the qubes-dist-upgrade tool. This is the in-place upgrade tool, which is not what weâ€™re doing. However, it will be needed in order to upgrade the templates to the 4.3 version. You install it with the following command in the dom0 terminal:

{{CodeSelect|code=
sudo qubes-dom0-update -y qubes-dist-upgrade
}}
|context=[https://doc.qubes-os.org/en/latest/user/downloading-installing-upgrading/upgrade/4_3.html How to upgrade to Qubes 4.3]
}}

{{quotation
|quote=
Change your templates to use the 4.3 repositories instead of the 4.2 ones. You do this with the following command in the dom0 terminal:

{{CodeSelect|code=
sudo qubes-dist-upgrade --releasever=4.3 --template-standalone-upgrade
}}
|context=[https://doc.qubes-os.org/en/latest/user/downloading-installing-upgrading/upgrade/4_3.html How to upgrade to Qubes 4.3]
}}

<u>Note:</u> The word "<code>standalone</code>" in the option "<code>--template-standalone-upgrade</code>" does not refer to "<code>Standalone VMs</code>". Instead, this is a command that can be used alone (standalone) to upgrade Qubes Templates from R4.2 to R4.3.

= Release Upgrade =

# Backup all data, ideally have a clone of the VM(s) so it is possible to try again (if necessary).
# Perform the usual [[Operating_System_Software_and_Updates#Standard_Upgrade_Steps|standard ("everyday") update instructions]].
# Run {{kicksecure_wiki
|wikipage=systemcheck
|text=systemcheck
}}.
# View <code>release-upgrade</code> command version: {{CodeSelect|inline=true|code=
cat /usr/sbin/release-upgrade {{!}} grep version=
}}
# Check <code>release-upgrade</code> command version. It should be a minimum of <code>3.3</code>, and display <code>version="3.3"</code>.
# Consider keeping the full release upgrade log output. It will be required for [[Support]] in case there are issues.
# Read [[Release_Upgrade_17_to_18#Platform_Specific_Notices|Platform Specific Notices]].
# Perform the automated [[Release Upgrade|release upgrade]] using the <code>release-upgrade</code> command: {{CodeSelect|inline=true|code=
sudo release-upgrade
}}
# Re-run the [[APT_Repository|repository-dist]] utility to update your derivative APT sources list from the old <code>.list</code> to the new <code>.sources</code> format. <ref>
https://forums.kicksecure.com/t/apt-sources-list-one-line-format-versus-deb822-style-format/267
</ref> This is a very minor issue if forgotten. It can be done at any later time. [[systemcheck]] will point this out if it has not been done yet.
# Done. If everything went well, at the end it will show: <blockquote>INFO: OK. (release-upgrade version: 3.3) Release upgrade success.</blockquote>
# Reboot.
# Optional, recommended: [[Debian_Packages|Re-install Meta Packages and Safely Run Autoremove]]

= Support the Future of {{project_name_short}} =
{{donation_appeal_download}}

= Footnotes =
{{reflist|close=1}}
[[Category:Documentation]]
{{Footer}}